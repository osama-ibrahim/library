<html>
    <body>
        <div class="api-result"></div>
        <script>
            var ajax = function(options) {
                var defaults = {
                    type: 'GET',
                    url: ''
                };

                for (var param in defaults) {
                    if (!options[param]) {
                        options[param] = defaults[param];
                    }
                }

                var xhr = new XMLHttpRequest();

                xhr.addEventListener('load', function() {
                    var obj;

                    try {
                        obj = JSON.parse(xhr.responseText);
                    } catch(e) {
                        return error({
                            message: 'Server Exception'
                        });
                    }

                    if (xhr.status >= 200 && xhr.status < 300) {
                        if (typeof options.success === 'function') {
                            options.success(obj);
                        }
                    } else if (xhr.status >= 400) {
                        if (typeof options.error === 'function') {
                            options.error(obj);
                        }
                    }
                });

                xhr.open(options.type, options.url, true);

                xhr.setRequestHeader('Content-Type', 'application/json');
                
                xhr.send(options.data && JSON.stringify(options.data));

                return xhr;
            };

            var get = function(url, success) {
                return ajax({
                    type: 'GET',
                    url: url,
                    success: success
                });
            };

            get('/api/v1/books', function(resp) {
                document.querySelector('.api-result').innerHTML = ['<h1>GET /api/v1/books</h1>', '', '<pre><code>', resp, '</code></pre>'].join('\n');
            });
        </script>
    </body>
</html>
